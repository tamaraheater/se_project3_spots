!function(){"use strict";function e(e,t,r="Save",o="Saving..."){e.textContent=t?o:r}function t(t,r,o="Saving..."){r.preventDefault();const n=r.submitter,a=n.textContent;return e(n,!0,a,o),t().then(e=>(r.target.reset(),e)).catch(e=>{console.error("Submission failed:",e)}).finally(()=>{e(n,!1,a,o)})}const r={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},o=(e,t,r)=>{const o=t.id+"-error-msg",n=e.querySelector("#"+o);t.classList.remove(r.inputErrorClass),n.classList.remove(r.errorClass),n.textContent=""},n=e=>e.some(e=>!e.validity.valid),a=(e,t,r)=>{n(e)?c(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))};function c(e,t){e.classList.add(t.inactiveButtonClass),e.disabled=!0}const s=(e,t,r)=>{t.forEach(t=>{o(e,t,r)});const a=e.querySelector(r.submitButtonSelector);n(t)&&c(a,r)},i=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}_request(e,t={}){const r={headers:this._headers,...t},o=`${this._baseUrl}${e}`;return fetch(o,r).then(this._checkResponse)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getAppInfo(){return Promise.all([this.getCards(),this.getUserInfo()])}getCards(){return this._request("/cards",{method:"GET"})}addCard({name:e,link:t}){return this._request("/cards",{method:"POST",body:JSON.stringify({name:e,link:t})})}deleteCard(e){return this._request(`/cards/${e}`,{method:"DELETE"})}getUserInfo(){return this._request("/users/me",{method:"GET"})}editUserInfo({name:e,about:t}){return this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:e,about:t})})}updateAvatar({avatar:e}){return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:e})})}changeLikeStatus(e,t){return this._request(`/cards/${e}/likes`,{method:t?"DELETE":"PUT"})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{"Content-Type":"application/json",authorization:"563217bb-cd86-459c-9285-cca63d6f8c1f"}});let l,d;const u=document.querySelector("#card-template"),m=document.querySelector(".cards__list"),_=document.querySelector(".profile__edit-button"),v=document.querySelector(".profile__name"),S=document.querySelector(".profile__description"),y=document.querySelector("#profile-avatar"),p=document.querySelector(".profile__avatar-button"),f=document.querySelector("#edit-open-modal"),b=f.querySelector(".modal__form"),q=f.querySelector(".modal__close-button"),h=f.querySelector("#profile-name-input"),E=f.querySelector("#profile-description-input"),L=document.querySelector(".profile__add-post-button"),k=document.querySelector("#new-post-modal"),g=k.querySelector(".modal__close-button"),C=k.querySelector(".modal__form"),x=C.querySelector("#card-image-input"),A=C.querySelector("#card-caption-input"),T=C.querySelector(".modal__submit-button"),U=document.querySelector("#avatar-open-modal"),w=U.querySelector(".modal__form"),B=U.querySelector("#profile-avatar-input"),I=U.querySelector(".modal__close-button"),P=w.querySelector(".modal__submit-button"),$=document.querySelector("#preview-modal"),D=$.querySelector(".modal__close-button"),N=$.querySelector(".modal__preview-image"),O=$.querySelector(".modal__preview-caption"),j=document.querySelector("#delete-modal"),J=j.querySelector(".modal__form"),F=j.querySelector(".modal__cancel-button"),G=j.querySelector(".modal__submit-button");function H(e){const t=u.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked&&n.classList.add("card__like-button_active"),n.addEventListener("click",t=>function(e,t){const r=e.target,o=r.classList.contains("card__like-button_active");i.changeLikeStatus(t,o).then(e=>{r.classList.toggle("card__like-button_active",e.isLiked)}).catch(e=>{console.error("Failed to toggle like:",e)})}(t,e._id)),o.addEventListener("click",()=>{N.src=e.link,N.alt=e.name,O.textContent=e.name,R($)}),a.addEventListener("click",()=>{l=t,d=e._id,R(j)}),t}function R(e){e.classList.add("modal_opened"),document.addEventListener("keydown",M)}function z(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",M)}function M(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&z(e)}}var K;i.getAppInfo().then(([e,t])=>{e.forEach(e=>{const t=H(e);m.append(t)}),v.textContent=t.name,S.textContent=t.about,y.src=t.avatar}).catch(e=>{console.error("Failed to fetch app info:",e)}),_.addEventListener("click",()=>{h.value=v.textContent,E.value=S.textContent,R(f),s(b,[h,E],r)}),L.addEventListener("click",()=>{R(k),s(C,[x,A],r),a([x,A],C.querySelector(".modal__submit-button"),r)}),p.addEventListener("click",()=>{R(U),s(w,[B],r),a([B],w.querySelector(".modal__submit-button"),r)}),q.addEventListener("click",()=>{z(f)}),T.addEventListener("click",()=>{z(k)}),g.addEventListener("click",()=>{z(k)}),D.addEventListener("click",()=>{z($)}),P.addEventListener("click",()=>{z(U)}),I.addEventListener("click",()=>{z(U)}),G.addEventListener("click",()=>{z(j)}),F.addEventListener("click",()=>{z(j)}),document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("mousedown",t=>{(t.target===e||t.target.classList.contains("modal__close-button"))&&z(e)})}),b.addEventListener("submit",function(e){t(function(){return i.editUserInfo({name:h.value,about:E.value}).then(e=>(v.textContent=e.name,S.textContent=e.about,z(f),e))},e,"Saving...")}),C.addEventListener("submit",function(e){t(function(){return i.addCard({name:A.value,link:x.value}).then(e=>{const t=H(e);return m.prepend(t),z(k),e})},e,"Saving...")}),w.addEventListener("submit",function(e){t(function(){return i.updateAvatar({avatar:B.value}).then(e=>(y.src=e.avatar,z(U),e))},e,"Saving...")}),J.addEventListener("submit",function(e){t(function(){return i.deleteCard(d).then(()=>{l.remove(),z(j)})},e,"Deleting...")}),K=r,document.querySelectorAll(K.formSelector).forEach(e=>{((e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector)),n=e.querySelector(t.submitButtonSelector);a(r,n,t),r.forEach(c=>{c.addEventListener("input",()=>{((e,t,r)=>{t.validity.valid?o(e,t,r):((e,t,r,o)=>{const n=t.id+"-error-msg",a=e.querySelector("#"+n);a.textContent=r,t.classList.add(o.inputErrorClass),a.classList.add(o.errorClass)})(e,t,t.validationMessage,r)})(e,c,t),a(r,n,t)})})})(e,K)})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QnZCa0ksRUFBQ3BJLEVBQWFDLEVBQWNvSSxFQUFjbkksS0FDL0QsTUFBTUMsRUFBYUYsRUFBYUcsR0FBSyxhQUMvQkMsRUFBc0JMLEVBQVlNLGNBQWMsSUFBTUgsR0FDNURFLEVBQW9COUIsWUFBYzhKLEVBQ2xDcEksRUFBYU0sVUFBVVksSUFBSWpCLEVBQU9MLGlCQUNsQ1EsRUFBb0JFLFVBQVVZLElBQUlqQixFQUFPSixhQWF2Q3NJLENBQ0VwSSxFQUNBQyxFQUNBQSxFQUFhcUksa0JBQ2JwSSxJQTZDQWlJLENBQW1CbkksRUFBYUMsRUFBY0MsR0FDOUNhLEVBQWtCTCxFQUFXTSxFQUFlZCxRQVE5QzhILENBQWtCaEksRUFBYUUsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3QzX3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdDNfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3QzX3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3QzX3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gc2V0QnV0dG9uVGV4dChcclxuICBidXR0b24sXHJcbiAgaXNMb2FkaW5nLFxyXG4gIGRlZmF1bHRUZXh0ID0gXCJTYXZlXCIsXHJcbiAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXHJcbikge1xyXG4gIGlmIChpc0xvYWRpbmcpIHtcclxuICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b24udGV4dENvbnRlbnQgPSBkZWZhdWx0VGV4dDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVTdWJtaXQocmVxdWVzdCwgZXZ0LCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzdWJtaXRCdXR0b24gPSBldnQuc3VibWl0dGVyO1xyXG4gIGNvbnN0IGluaXRpYWxUZXh0ID0gc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnV0dG9uLCB0cnVlLCBpbml0aWFsVGV4dCwgbG9hZGluZ1RleHQpO1xyXG4gIHJldHVybiByZXF1ZXN0KClcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGV2dC50YXJnZXQucmVzZXQoKTtcclxuICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIlN1Ym1pc3Npb24gZmFpbGVkOlwiLCBlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdXR0b24sIGZhbHNlLCBpbml0aWFsVGV4dCwgbG9hZGluZ1RleHQpO1xyXG4gICAgfSk7XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTXNnSUQgPSBpbnB1dEVsZW1lbnQuaWQgKyBcIi1lcnJvci1tc2dcIjtcclxuICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yTXNnSUQpO1xyXG4gIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5lcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTXNnSUQgPSBpbnB1dEVsZW1lbnQuaWQgKyBcIi1lcnJvci1tc2dcIjtcclxuICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yTXNnSUQpO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuZXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKFxyXG4gICAgICBmb3JtRWxlbWVudCxcclxuICAgICAgaW5wdXRFbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsXHJcbiAgICAgIGNvbmZpZ1xyXG4gICAgKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcclxuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpIHtcclxuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBpbnB1dExpc3QsIGNvbmZpZykgPT4ge1xyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0LCBjb25maWcpO1xyXG4gIH0pO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxyXG4gICk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcbiIsImltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcclxuaW1wb3J0IHsgaGFuZGxlU3VibWl0IH0gZnJvbSBcIi4uL3V0aWxzL2hlbHBlcnMuanNcIjtcclxuaW1wb3J0IHtcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbiAgcmVzZXRWYWxpZGF0aW9uLFxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlLFxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcclxuXHJcbi8vIEluc3RhbnRpYXRlIEFwaVxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjU2MzIxN2JiLWNkODYtNDU5Yy05Mjg1LWNjYTYzZDZmOGMxZlwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxubGV0IHNlbGVjdGVkQ2FyZCwgc2VsZWN0ZWRDYXJkSUQ7XHJcblxyXG4vLyBDYXJkIFZhcmlhYmxlc1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XHJcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcblxyXG4vLyBQcm9maWxlIFZhcmlhYmxlc1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhclwiKTtcclxuY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ1dHRvblwiKTtcclxuXHJcbi8vIEVkaXQgTW9kYWwgVmFyaWFibGVzXHJcbmNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1vcGVuLW1vZGFsXCIpO1xyXG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgZWRpdE1vZGFsQ2xvc2VCdXR0b24gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xyXG5jb25zdCBlZGl0TW9kYWxOYW1lSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuXHJcbi8vIE5ldyBQb3N0IFZhcmlhYmxlc1xyXG5jb25zdCBuZXdQb3N0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtcG9zdC1idXR0b25cIik7XHJcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XHJcbmNvbnN0IG5ld1Bvc3RDbG9zZUJ1dHRvbiA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XHJcbmNvbnN0IG5ld1Bvc3RGb3JtRWxlbWVudCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBuZXdQb3N0SW1hZ2VJbnB1dCA9IG5ld1Bvc3RGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2UtaW5wdXRcIik7XHJcbmNvbnN0IG5ld1Bvc3RDYXB0aW9uSW5wdXQgPSBuZXdQb3N0Rm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNjYXJkLWNhcHRpb24taW5wdXRcIlxyXG4pO1xyXG5jb25zdCBuZXdQb3N0U3VibWl0QnV0dG9uID0gbmV3UG9zdEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIlxyXG4pO1xyXG5cclxuLy8gQXZhdGFyIE1vZGFsIFZhcmlhYmxlc1xyXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW9wZW4tbW9kYWxcIik7XHJcbmNvbnN0IGF2YXRhckZvcm1FbGVtZW50ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYXZhdGFyLWlucHV0XCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbENsb3NlQnV0dG9uID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCJcclxuKTtcclxuY29uc3QgYXZhdGFyU3VibWl0QnV0dG9uID0gYXZhdGFyRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiXHJcbik7XHJcblxyXG4vLyBQcmV2aWV3IE1vZGFsIFZhcmlhYmxlc1xyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbENsb3NlQnV0dG9uID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXHJcbik7XHJcbmNvbnN0IG1vZGFsUHJldmlld0ltYWdlRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcclxuY29uc3QgbW9kYWxQcmV2aWV3Q2FwdGlvbkVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX3ByZXZpZXctY2FwdGlvblwiXHJcbik7XHJcbi8vRGVsZXRlIE1vZGVcclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlRm9ybUVsZW1lbnQgPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBjYW5jZWxEZWxldGVCdXR0b24gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYW5jZWwtYnV0dG9uXCIpO1xyXG5jb25zdCBjYXJkRGVsZXRlQnV0dG9uID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuXHJcbmFwaVxyXG4gIC5nZXRBcHBJbmZvKClcclxuICAudGhlbigoW2NhcmRzLCBkYXRhXSkgPT4ge1xyXG4gICAgY2FyZHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xyXG4gICAgICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICAgIHByb2ZpbGVBdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCBhcHAgaW5mbzpcIiwgZXJyKTtcclxuICB9KTtcclxuXHJcbi8vIEhhbmRsZSBsaWtlIGJ1dHRvbiBjbGlja3NcclxuZnVuY3Rpb24gaGFuZGxlTGlrZShldnQsIGlkKSB7XHJcbiAgY29uc3QgY2FyZExpa2VCdXR0b25FbCA9IGV2dC50YXJnZXQ7XHJcbiAgY29uc3QgY2FyZElzTGlrZWQgPSBjYXJkTGlrZUJ1dHRvbkVsLmNsYXNzTGlzdC5jb250YWlucyhcclxuICAgIFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCJcclxuICApO1xyXG5cclxuICBhcGlcclxuICAgIC5jaGFuZ2VMaWtlU3RhdHVzKGlkLCBjYXJkSXNMaWtlZClcclxuICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xyXG4gICAgICBjYXJkTGlrZUJ1dHRvbkVsLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIixcclxuICAgICAgICB1cGRhdGVkQ2FyZC5pc0xpa2VkXHJcbiAgICAgICk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB0b2dnbGUgbGlrZTpcIiwgZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBDYXJkIEVsZW1lbnQgRnVuY3Rpb25zXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGNhcmROYW1lRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgY29uc3QgY2FyZEltYWdlRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgY29uc3QgY2FyZExpa2VCdXR0b25FbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgY29uc3QgY2FyZERlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuXHJcbiAgY2FyZE5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gIGNhcmRJbWFnZUVsZW1lbnQuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRJbWFnZUVsZW1lbnQuYWx0ID0gZGF0YS5uYW1lO1xyXG5cclxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XHJcbiAgICBjYXJkTGlrZUJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBjYXJkTGlrZUJ1dHRvbkVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PlxyXG4gICAgaGFuZGxlTGlrZShldnQsIGRhdGEuX2lkKVxyXG4gICk7XHJcblxyXG4gIGNhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIG1vZGFsUHJldmlld0ltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgbW9kYWxQcmV2aWV3SW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICBtb2RhbFByZXZpZXdDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcclxuICB9KTtcclxuXHJcbiAgY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgICBzZWxlY3RlZENhcmRJRCA9IGRhdGEuX2lkO1xyXG4gICAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG4vLyBNb2RhbCBGdW5jdGlvbnNcclxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XHJcbiAgICBpZiAob3BlbmVkTW9kYWwpIGNsb3NlTW9kYWwob3BlbmVkTW9kYWwpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gQnV0dG9uIEV2ZW50IExpc3RlbmVyc1xyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgb3Blbk1vZGFsKGVkaXRNb2RhbCk7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKFxyXG4gICAgZWRpdEZvcm1FbGVtZW50LFxyXG4gICAgW2VkaXRNb2RhbE5hbWVJbnB1dCwgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dF0sXHJcbiAgICB2YWxpZGF0aW9uQ29uZmlnXHJcbiAgKTtcclxufSk7XHJcblxyXG5uZXdQb3N0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKG5ld1Bvc3RNb2RhbCk7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKFxyXG4gICAgbmV3UG9zdEZvcm1FbGVtZW50LFxyXG4gICAgW25ld1Bvc3RJbWFnZUlucHV0LCBuZXdQb3N0Q2FwdGlvbklucHV0XSxcclxuICAgIHZhbGlkYXRpb25Db25maWdcclxuICApO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKFxyXG4gICAgW25ld1Bvc3RJbWFnZUlucHV0LCBuZXdQb3N0Q2FwdGlvbklucHV0XSxcclxuICAgIG5ld1Bvc3RGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpLFxyXG4gICAgdmFsaWRhdGlvbkNvbmZpZ1xyXG4gICk7XHJcbn0pO1xyXG5cclxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG9wZW5Nb2RhbChhdmF0YXJNb2RhbCk7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKGF2YXRhckZvcm1FbGVtZW50LCBbYXZhdGFySW5wdXRdLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB0b2dnbGVCdXR0b25TdGF0ZShcclxuICAgIFthdmF0YXJJbnB1dF0sXHJcbiAgICBhdmF0YXJGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpLFxyXG4gICAgdmFsaWRhdGlvbkNvbmZpZ1xyXG4gICk7XHJcbn0pO1xyXG5cclxuZWRpdE1vZGFsQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XHJcbn0pO1xyXG5cclxubmV3UG9zdFN1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcclxufSk7XHJcblxyXG5uZXdQb3N0Q2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XHJcbn0pO1xyXG5cclxucHJldmlld01vZGFsQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbn0pO1xyXG5cclxuYXZhdGFyU3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XHJcbn0pO1xyXG5cclxuYXZhdGFyTW9kYWxDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59KTtcclxuXHJcbmNhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufSk7XHJcblxyXG5jYW5jZWxEZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufSk7XHJcblxyXG4vLyBDbG9zZSBNb2RhbFxyXG5jb25zdCBtb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xyXG5tb2RhbHMuZm9yRWFjaCgobW9kYWwpID0+IHtcclxuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgIGlmIChcclxuICAgICAgZXZ0LnRhcmdldCA9PT0gbW9kYWwgfHxcclxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgICApIHtcclxuICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLy9Gb3JtIEhhbmRsZXJzXHJcbi8vIFByb2ZpbGUgRm9ybSBIYW5kbGVyXHJcbmVkaXRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgIHJldHVybiBhcGlcclxuICAgICAgLmVkaXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZTogZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlLFxyXG4gICAgICAgIGFib3V0OiBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlLFxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWU7XHJcbiAgICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgICAgICAgY2xvc2VNb2RhbChlZGl0TW9kYWwpO1xyXG4gICAgICAgIHJldHVybiB1c2VyRGF0YTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4gIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZXZ0LCBcIlNhdmluZy4uLlwiKTtcclxufSk7XHJcblxyXG5uZXdQb3N0Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbiAgICByZXR1cm4gYXBpXHJcbiAgICAgIC5hZGRDYXJkKHtcclxuICAgICAgICBuYW1lOiBuZXdQb3N0Q2FwdGlvbklucHV0LnZhbHVlLFxyXG4gICAgICAgIGxpbms6IG5ld1Bvc3RJbWFnZUlucHV0LnZhbHVlLFxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigobmV3UG9zdCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQobmV3UG9zdCk7XHJcbiAgICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcclxuICAgICAgICByZXR1cm4gbmV3UG9zdDtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4gIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZXZ0LCBcIlNhdmluZy4uLlwiKTtcclxufSk7XHJcblxyXG5hdmF0YXJGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgIHJldHVybiBhcGkudXBkYXRlQXZhdGFyKHsgYXZhdGFyOiBhdmF0YXJJbnB1dC52YWx1ZSB9KS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVBdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gICAgICByZXR1cm4gZGF0YTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGV2dCwgXCJTYXZpbmcuLi5cIik7XHJcbn0pO1xyXG5cclxuZGVsZXRlRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbiAgICByZXR1cm4gYXBpLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSUQpLnRoZW4oKCkgPT4ge1xyXG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZXZ0LCBcIkRlbGV0aW5nLi4uXCIpO1xyXG59KTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7XHJcbiIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfcmVxdWVzdChlbmRwb2ludCwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICBjb25zdCBmaW5hbE9wdGlvbnMgPSB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIC4uLm9wdGlvbnMsXHJcbiAgICB9O1xyXG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5fYmFzZVVybH0ke2VuZHBvaW50fWA7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCBmaW5hbE9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FyZHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi9jYXJkc1wiLCB7IG1ldGhvZDogXCJHRVRcIiB9KTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL2NhcmRzXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke2NhcmRJZH1gLCB7IG1ldGhvZDogXCJERUxFVEVcIiB9KTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWVcIiwgeyBtZXRob2Q6IFwiR0VUXCIgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VMaWtlU3RhdHVzKGNhcmRJZCwgaXNMaWtlZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcbiJdLCJuYW1lcyI6WyJzZXRCdXR0b25UZXh0IiwiYnV0dG9uIiwiaXNMb2FkaW5nIiwiZGVmYXVsdFRleHQiLCJsb2FkaW5nVGV4dCIsInRleHRDb250ZW50IiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0QnV0dG9uIiwic3VibWl0dGVyIiwiaW5pdGlhbFRleHQiLCJ0aGVuIiwiZGF0YSIsInRhcmdldCIsInJlc2V0IiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJmaW5hbGx5IiwidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImNvbmZpZyIsImVycm9yTXNnSUQiLCJpZCIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiaGFzSW52YWxpZElucHV0IiwiaW5wdXRMaXN0Iiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiYnV0dG9uRWxlbWVudCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsInJlc2V0VmFsaWRhdGlvbiIsImZvckVhY2giLCJhcGkiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfcmVxdWVzdCIsImVuZHBvaW50Iiwib3B0aW9ucyIsImZpbmFsT3B0aW9ucyIsInVybCIsImZldGNoIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0QXBwSW5mbyIsImFsbCIsImdldENhcmRzIiwiZ2V0VXNlckluZm8iLCJtZXRob2QiLCJhZGRDYXJkIiwibmFtZSIsImxpbmsiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJlZGl0VXNlckluZm8iLCJhYm91dCIsInVwZGF0ZUF2YXRhciIsImF2YXRhciIsImNoYW5nZUxpa2VTdGF0dXMiLCJpc0xpa2VkIiwiYXV0aG9yaXphdGlvbiIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElEIiwiY2FyZFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjYXJkc0xpc3QiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUF2YXRhciIsImF2YXRhckVkaXRCdXR0b24iLCJlZGl0TW9kYWwiLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0TW9kYWxDbG9zZUJ1dHRvbiIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJuZXdQb3N0QnV0dG9uIiwibmV3UG9zdE1vZGFsIiwibmV3UG9zdENsb3NlQnV0dG9uIiwibmV3UG9zdEZvcm1FbGVtZW50IiwibmV3UG9zdEltYWdlSW5wdXQiLCJuZXdQb3N0Q2FwdGlvbklucHV0IiwibmV3UG9zdFN1Ym1pdEJ1dHRvbiIsImF2YXRhck1vZGFsIiwiYXZhdGFyRm9ybUVsZW1lbnQiLCJhdmF0YXJJbnB1dCIsImF2YXRhck1vZGFsQ2xvc2VCdXR0b24iLCJhdmF0YXJTdWJtaXRCdXR0b24iLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3TW9kYWxDbG9zZUJ1dHRvbiIsIm1vZGFsUHJldmlld0ltYWdlRWwiLCJtb2RhbFByZXZpZXdDYXB0aW9uRWwiLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm1FbGVtZW50IiwiY2FuY2VsRGVsZXRlQnV0dG9uIiwiY2FyZERlbGV0ZUJ1dHRvbiIsImdldENhcmRFbGVtZW50IiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbGVtZW50IiwiY2FyZEltYWdlRWxlbWVudCIsImNhcmRMaWtlQnV0dG9uRWwiLCJzcmMiLCJhbHQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2FyZElzTGlrZWQiLCJjb250YWlucyIsInVwZGF0ZWRDYXJkIiwidG9nZ2xlIiwiaGFuZGxlTGlrZSIsIl9pZCIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwiaGFuZGxlRXNjYXBlIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJvcGVuZWRNb2RhbCIsImNhcmRzIiwiaXRlbSIsImFwcGVuZCIsInZhbHVlIiwicXVlcnlTZWxlY3RvckFsbCIsInVzZXJEYXRhIiwibmV3UG9zdCIsInByZXBlbmQiLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlIiwidmFsaWRhdGlvbk1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9